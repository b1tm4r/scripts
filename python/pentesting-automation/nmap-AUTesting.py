import os

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKCYAN = '\033[96m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

print("\n"+"########################################################")
print("############# NMAP AUTOMATION TOOL SCRIPT ##############")
print("########################################################")
print("###################### by: b1tm4r ######################")
print("########################################################"+"\n")
host=input(bcolors.OKBLUE + "Insert host/network to scan: " + bcolors.OKCYAN + bcolors.ENDC)
print(bcolors.OKBLUE + "\n"+f"Target: " + bcolors.ENDC + bcolors.OKCYAN + host + "\n" + bcolors.ENDC)
print(bcolors.OKBLUE + "Select which scan you want to make: " + bcolors.ENDC + "\n")
while True:
  print(bcolors.FAIL + "1. Scan network range" + bcolors.ENDC)
  print(bcolors.FAIL + "2. Scan Top 10 TCP ports" + bcolors.ENDC)
  print(bcolors.FAIL + "3. Scan Connect scan" + bcolors.ENDC)
  print(bcolors.FAIL + "4. Scan Full UDP ports" + bcolors.ENDC)
  print(bcolors.FAIL + "5. Scan script vuln assessment" + bcolors.ENDC)
  print(bcolors.FAIL + "6. Scan decoy for IDS/IPS" + bcolors.ENDC)
  print(bcolors.FAIL + "7. Scan Full TCP ports" + bcolors.ENDC + "\n")
  scantype=int(input())
  if scantype==1:
    print(bcolors.WARNING + "\n" + "Scan type selected 'Scan network range', starting..." + bcolors.ENDC + "\n")
    os.system(f"nmap {host} -sn -oA {host}-network.nmap"+"\n")
    print(f"Scan results will be stored as {host}-network.nmap"+"\n")
  elif scantype==2:
    print(bcolors.WARNING + "\n" + "Scan type selected 'Scan Top 10 TCP ports', starting... " + bcolors.ENDC + "\n")
    os.system(f"nmap {host} --top-ports=10 -oA {host}-top10.nmap"+"\n")
    break
  elif scantype==3:
    print(bcolors.WARNING + "\n" + "Scan type selected 'Scan Connect scan', starting..." + bcolors.ENDC + "\n")
    os.system(f"nmap {host} -p 443 --packet-trace --disable-arp-ping -Pn -n --reason -sT -oA {host}-conn.nmap"+"\n")
    break
  elif scantype==4:
    print(bcolors.WARNING + "\n" + "Scan type selected 'Full UDP ports', starting..." + bcolors.ENDC + "\n")
    os.system(f"nmap {host} -n -v -sU -p- -T5 -sV -oA {host}-fulludp.nmap"+"\n")
    break
  elif scantype==5:
    print(bcolors.WARNING + "\n" + "Scan type selected 'Scan script vuln assessment', starting..." + bcolors.ENDC + "\n")
    os.system(f"nmap {host} -p- -sV --script vuln -oA {host}-vuln.nmap"+"\n")
    break
  elif scantype==6:
    print(bcolors.WARNING + "\n" + "Scan type selected 'Scan decoy for IDS/IPS', starting..." + bcolors.ENDC + "\n")
    os.system(f"nmap {host} -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5 -oA {host}-decoy.nmap"+"\n")
    break
  elif scantype==7:
    print(bcolors.WARNING + "\n" + "Scan type selected 'Full TCP ports', starting..." + bcolors.ENDC + "\n")
    os.system(f"nmap {host} -n -v -sT -p- -T5 -sV -oA {host}-fulltcp.nmap"+"\n")
    break
  fi
