import os
print("\n"+"########################################################")
print("########## PENTESTING AUTOMATION TOOLS SCRIPT ##########")
print("########################################################")
print("###################### by: b1tm4r ######################")
print("########################################################"+"\n")
host=input("Insert host to scan: ")
print("\n"+f"Target: {host}"+"\n")
print("Select which scan you want to make: "+"\n")
while True:
  print("1. nmap")
  print("2. dirb")
  print("3. nikto")
  print("4. testssl"+"\n")

  scantype=int(input())
  if scantype==1:
    print("\n"+"Scan type selected 'NMAP', starting..."+"\n")
    os.system(f"nmap -sV -n -v -Pn -p- -T4 {host} -A --open -oN {host}.nmap"+"\n")
    print(f"Scan results will be stored as {host}.nmap"+"\n")
  elif scantype==2:
    port=int(input("\n"+"Insert port to directory enumeration: "))
    print("\n"+"Scan type selected 'DIRB', starting..."+"\n")
    if port==80:
       os.system(f"dirb http://{host} /usr/share/wordlists/dirb/big.txt -o {host}.-p{port}.dirb"+"\n")
    elif port==443:
       os.system(f"dirb https://{host} /usr/share/wordlists/dirb/big.txt -o {host}.-p{port}.dirb"+"\n")
    else:
       os.system(f"dirb https://{host}:{port} /usr/share/wordlists/dirb/big.txt -o {host}.-p{port}.dirb"+"\n")
    break
  elif scantype==3:
    port=int(input("\n"+"Insert port to scan with nikto: "))
    print("\n"+"Scan type selected 'NIKTO', starting..."+"\n")
    if port==80:
       os.system(f"nikto -h http://{host} -output {host}.-p{port}-nikto.txt"+"\n")
    elif port==443:
       os.system(f"nikto -h https://{host} -output {host}.-p{port}-nikto.txt"+"\n")
    else:
       os.system(f"nikto -h https://{host}:{port} -output {host}.-p{port}-nikto.txt"+"\n")
    break
  elif scantype==4:
    port=int(input("\n"+"Insert port to find WEAK TLS vulnerabilities: "))
    print("\n"+"Scan type selected 'TESTSSL', starting..."+"\n")
    if port==80:
       os.system(f"testssl --json-pretty -p -U {host}:{port}"+"\n")
    elif port==443:
       os.system(f"testssl --json-pretty -p -U {host}:{port}"+"\n")
    else:
       os.system(f"testssl --json-pretty -p -U {host}:{port}"+"\n")
    break
  else:
    break
